#!/bin/bash

if [ -f $1 ]; then
  cat $1 | tr '\n' ' '
  exit
fi

SERVICE=$1

if [ "$2" = "" ] || [ "$2" = "hm" ] || [ "$2" = "http " ] || [ "$2" = "tcp" ]; then
  PODS="sto1 lon2 ash1 sjc1 sto3 lon3 ash2"

else
  PODS=$2
  shift
fi

if [ "$2" != "" ]; then
  PROTO=$2
else
  PROTO="http"
fi

for pod in $PODS
do
  echo -n $(dig _spotify-${SERVICE}._${PROTO}.$pod.spotify.net SRV +short \
    | grep -v ';' \
    | awk '{print $4}' \
    | sort \
    | uniq \
    | sed 's/\.$//')
  echo -n ' '
done
echo
